// src/components/OpenWebUILoader.jsx
import React from 'react'
import { motion } from 'framer-motion'

/**
 * OpenWebUILoader
 * - lines: number of skeleton rows to render
 * - compact: if true, renders slimmer rows (for tighter UI)
 * - variant: 'dark' | 'muted' (controls color mood)
 */
export default function OpenWebUILoader({ lines = 4, compact = false, variant = 'dark' }) {
  const rowHeight = compact ? 10 : 14
  const gap = compact ? 8 : 12

  // staggered animation config
  const container = {
    hidden: { opacity: 1 },
    show: {
      opacity: 1,
      transition: {
        staggerChildren: 0.10
      }
    }
  }

  const item = {
    hidden: { opacity: 0.18, y: 4, scale: 0.995 },
    show: i => ({
      opacity: [0.18, 0.48, 0.28],
      y: [4, 0, 2],
      scale: [0.995, 1.002, 0.998],
      transition: {
        duration: 1.1,
        ease: 'easeInOut',
        repeat: Infinity,
        repeatDelay: 0.3,
        delay: i * 0.07
      }
    })
  }

  // row widths for more organic look
  const widths = [0.92, 0.78, 0.86, 0.62, 0.74, 0.9]

  const baseClass = variant === 'dark' ? 'owu-skel-dark' : 'owu-skel-muted'

  return (
    <motion.div
      className={`w-full flex flex-col gap-${gap}`}
      variants={container}
      initial="hidden"
      animate="show"
      style={{ display: 'flex', flexDirection: 'column', gap: gap }}
      aria-hidden="true"
    >
      {Array.from({ length: lines }).map((_, i) => (
        <motion.div
          key={i}
          custom={i}
          variants={item}
          className={`${baseClass} owu-skel-row rounded-md`}
          style={{
            height: rowHeight,
            width: `${Math.round((widths[i % widths.length]) * 100)}%`,
            alignSelf: i % 2 === 0 ? 'flex-start' : 'flex-end'
          }}
        />
      ))}
    </motion.div>
  )
}
################################333
/* OpenWebUI-like skeleton styles */
.owu-skel-row {
  position: relative;
  overflow: hidden;
  background-clip: padding-box;
  box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02);
}

/* dark mood (low & deep) */
.owu-skel-dark {
  background: linear-gradient(90deg, rgba(18,20,25,0.86) 0%, rgba(28,30,38,0.92) 50%, rgba(18,20,25,0.86) 100%);
  border: 1px solid rgba(255,255,255,0.02);
  box-shadow: 0 6px 18px rgba(2,6,23,0.28);
}

/* muted mood (lighter) */
.owu-skel-muted {
  background: linear-gradient(90deg, rgba(230,230,235,0.9) 0%, rgba(240,240,245,0.95) 50%, rgba(230,230,235,0.9) 100%);
  border: 1px solid rgba(0,0,0,0.04);
}

/* shimmer overlay */
.owu-skel-row::after {
  content: "";
  position: absolute;
  inset: 0;
  background-image: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.06) 45%, rgba(255,255,255,0.12) 50%, rgba(255,255,255,0.06) 55%, rgba(255,255,255,0) 100%);
  transform: translateX(-120%);
  animation: owu-shimmer 1.4s linear infinite;
  will-change: transform;
  pointer-events: none;
}

/* subtle dark flash (pulse) â€” sits behind shimmer to create low/dim flash */
@keyframes owu-shimmer {
  0% { transform: translateX(-120%); opacity: 0.9; }
  50% { transform: translateX(20%); opacity: 1; }
  100% { transform: translateX(120%); opacity: 0.9; }
}

/* smaller responsive gaps for compact mode (tailwind-like fallback if necessary) */
.gap-8 { gap: 8px; }
.gap-12 { gap: 12px; }

/* rounded subtleness */
.rounded-md { border-radius: 10px; }

/* optional: reduce motion for users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  .owu-skel-row::after { animation: none; }
  .owu-skel-row { transition: none; }
}
