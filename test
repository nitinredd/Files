        # Optimization analysis
        if check_same_time_points(reference_df, test_df):
            combos = generate_valid_combinations(reference_df, test_df, "FDA")
            results = []
            for combo in combos:
                ref_sub = reference_df[reference_df.iloc[:,0].isin(combo)]
                test_sub = test_df[test_df.iloc[:,0].isin(combo)]
                f2 = calculate_combination_f2(ref_sub, test_sub)
                if f2: 
                    results.append({'times': combo, 'f2': f2})
            display_optimization(results)
