============================================================
CONVERTING LHS DATA TO NUMERIC
============================================================
Original data rows: 7
Columns per row: 6

Sample row conversion:
  Original: ['10.14239', '2.77589', '114.60209', '0.67520', '1.12602', '1.80122']
  Numeric:  [10.14239, 2.77589, 114.60209, 0.6752, 1.12602, 1.80122]

✓ Created final_result with 7 data rows

Converting DataFrame columns to numeric before saving to Excel...
  Equivalence 2                 : float64 -> float64
  Residence Time 1              : float64 -> float64
  Temperature                   : float64 -> float64
  Pump Flowrate 1               : float64 -> float64
  Pump Flowrate 2               : float64 -> float64
  Total Flowrate                : float64 -> float64
✓ Excel file saved to: C:\Users\T00078322\Documents\test\optimization.xlsx
INFO:     127.0.0.1:64100 - "POST /sor/api/update/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64114 - "WebSocket /ws/file-uploads/6979a8ea4f50902bc315cd86" [accepted]
WebSocket connected for ID 6979a8ea4f50902bc315cd86 with path: C:\Users\T00078322\Documents\test
INFO:     connection open
INFO:     127.0.0.1:64100 - "OPTIONS /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64100 - "GET /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
Raw RT Min from UI: ['1.3', '2.5']
Raw RT Max from UI: ['1.5', '2.7']
CORRECTED RT parameters:
  Yield RT: [1.3-1.5]
  Impurity RT ranges: [(2.5, 2.7)]
  Internal Standard RT: [0.0-10.0]
Checking for range overlaps:
WARNING: Yield [1.3-1.5] overlaps with ISO [0.0-10.0]
WARNING: ISO [0.0-10.0] overlaps with Impurity1 [2.5-2.7]

Transformed objectives: [{'name': 'oop', 'maximize': True, 'Property': 'oop'}, {'name': 'oops', 'maximize': False, 'Property': 'oops'}]        

============================================================
PREPARING DATAFRAME FOR OPTIMIZATION
============================================================
Original DataFrame shape: (7, 8)
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Original DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                  object
oops                 object
dtype: object

Objective columns: ['oop', 'oops']
  Equivalence 2                 : float64 -> float64
    Sample: 10.14239 -> 10.14239 (7/7 valid)
  Residence Time 1              : float64 -> float64
    Sample: 2.77589 -> 2.77589 (7/7 valid)
  Temperature                   : float64 -> float64
    Sample: 114.60209 -> 114.60209 (7/7 valid)
  Pump Flowrate 1               : float64 -> float64
    Sample: 0.6752 -> 0.6752 (7/7 valid)
  Pump Flowrate 2               : float64 -> float64
    Sample: 1.12602 -> 1.12602 (7/7 valid)
  Total Flowrate                : float64 -> float64
    Sample: 1.80122 -> 1.80122 (7/7 valid)
  oop                           : object -> float64
    Sample:  -> nan (0/7 valid)
  oops                          : object -> float64
    Sample:  -> nan (0/7 valid)

Converted DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                 float64
oops                float64
dtype: object

Sample data (first row):
  Equivalence 2                 : 10.14239 (type: float64)
  Residence Time 1              : 2.77589 (type: float64)
  Temperature                   : 114.60209 (type: float64)
  Pump Flowrate 1               : 0.6752 (type: float64)
  Pump Flowrate 2               : 1.12602 (type: float64)
  Total Flowrate                : 1.80122 (type: float64)
  oop                           : nan (type: float64)
  oops                          : nan (type: float64)
HPLC file loaded: C:\Users\T00078322\Documents\test\Page 10.csv
HPLC file columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
HPLC file shape: (47, 5)
Sample HPLC data:
  Sample Name     RT   Area  Peak Area Percent  Signal Dimension
0    Sample-1  0.044   0.02               0.00                 1
1    Sample-1  0.114   0.01               0.00                 1
2    Sample-1  0.253   0.07               0.00                 1
3    Sample-1  0.442   0.04               0.00                 1
4    Sample-1  0.595  82.30               0.43                 1
RT range in file: 0.044 - 9.885

Experiment Status:
  Completed: 1/7 LHS
  SOR Iterations: 0/2

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10.csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
HPLC processing completed. Response: [0.5821658911311641, 0.049024294593808734]
Row 1 values: [10.14239, 2.77589, 114.60209, 0.6752, 1.12602, 1.80122, '', '']
Empty/NaN indices found: [6, 7]
Response values to fill: [0.5821658911311641, 0.049024294593808734]
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0       10.14239           2.77589    114.60209          0.67520          1.12602         1.80122  0.582166  0.049024
1        7.03560           4.54285    133.83608          0.51030          0.59033         1.10063
2       11.75071           3.35094    105.33866          0.50888          0.98323         1.49212
3       13.83123           1.08853    126.13620          1.40288          3.19048         4.59337
4        7.98274           1.94811     97.44059          1.10984          1.45675         2.56659
5       13.37266           4.15638     90.78112          0.37607          0.82691         1.20297
6        5.74893           2.61046    119.66735          0.98462          0.93075         1.91537                     Dataframe before insertions
Row 1 updated. Excel saved to C:\Users\T00078322\Documents\test\optimization.xlsx and MongoDB updated.
INFO:     127.0.0.1:64126 - "OPTIONS /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64126 - "GET /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
Raw RT Min from UI: ['1.3', '2.5']
Raw RT Max from UI: ['1.5', '2.7']
CORRECTED RT parameters:
  Yield RT: [1.3-1.5]
  Impurity RT ranges: [(2.5, 2.7)]
  Internal Standard RT: [0.0-10.0]
Checking for range overlaps:
WARNING: Yield [1.3-1.5] overlaps with ISO [0.0-10.0]
WARNING: ISO [0.0-10.0] overlaps with Impurity1 [2.5-2.7]

Transformed objectives: [{'name': 'oop', 'maximize': True, 'Property': 'oop'}, {'name': 'oops', 'maximize': False, 'Property': 'oops'}]        

============================================================
PREPARING DATAFRAME FOR OPTIMIZATION
============================================================
Original DataFrame shape: (7, 8)
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Original DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                  object
oops                 object
dtype: object

Objective columns: ['oop', 'oops']
  Equivalence 2                 : float64 -> float64
    Sample: 10.14239 -> 10.14239 (7/7 valid)
  Residence Time 1              : float64 -> float64
    Sample: 2.77589 -> 2.77589 (7/7 valid)
  Temperature                   : float64 -> float64
    Sample: 114.60209 -> 114.60209 (7/7 valid)
  Pump Flowrate 1               : float64 -> float64
    Sample: 0.6752 -> 0.6752 (7/7 valid)
  Pump Flowrate 2               : float64 -> float64
    Sample: 1.12602 -> 1.12602 (7/7 valid)
  Total Flowrate                : float64 -> float64
    Sample: 1.80122 -> 1.80122 (7/7 valid)
  oop                           : object -> float64
    Sample: 0.5821658911311641 -> 0.5821658911311641 (1/7 valid)
  oops                          : object -> float64
    Sample: 0.049024294593808734 -> 0.049024294593808734 (1/7 valid)

Converted DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                 float64
oops                float64
dtype: object

Sample data (first row):
  Equivalence 2                 : 10.14239 (type: float64)
  Residence Time 1              : 2.77589 (type: float64)
  Temperature                   : 114.60209 (type: float64)
  Pump Flowrate 1               : 0.6752 (type: float64)
  Pump Flowrate 2               : 1.12602 (type: float64)
  Total Flowrate                : 1.80122 (type: float64)
  oop                           : 0.5821658911311641 (type: float64)
  oops                          : 0.049024294593808734 (type: float64)
HPLC file loaded: C:\Users\T00078322\Documents\test\Page 10 - Copy.csv
HPLC file columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
HPLC file shape: (47, 5)
Sample HPLC data:
  Sample Name     RT   Area  Peak Area Percent  Signal Dimension
0    Sample-1  0.044   0.02               0.00                 1
1    Sample-1  0.114   0.01               0.00                 1
2    Sample-1  0.253   0.07               0.00                 1
3    Sample-1  0.442   0.04               0.00                 1
4    Sample-1  0.595  82.30               0.43                 1
RT range in file: 0.044 - 9.885

Experiment Status:
  Completed: 2/7 LHS
  SOR Iterations: 0/2

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10 - Copy.csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
HPLC processing completed. Response: [0.5821658911311641, 0.049024294593808734]
Row 2 values: [7.0356, 4.54285, 133.83608, 0.5103, 0.59033, 1.10063, '', '']
Empty/NaN indices found: [6, 7]
Response values to fill: [0.5821658911311641, 0.049024294593808734]
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0       10.14239           2.77589    114.60209          0.67520          1.12602         1.80122  0.582166  0.049024
1        7.03560           4.54285    133.83608          0.51030          0.59033         1.10063  0.582166  0.049024
2       11.75071           3.35094    105.33866          0.50888          0.98323         1.49212
3       13.83123           1.08853    126.13620          1.40288          3.19048         4.59337
4        7.98274           1.94811     97.44059          1.10984          1.45675         2.56659
5       13.37266           4.15638     90.78112          0.37607          0.82691         1.20297
6        5.74893           2.61046    119.66735          0.98462          0.93075         1.91537                     Dataframe before insertions
Row 2 updated. Excel saved to C:\Users\T00078322\Documents\test\optimization.xlsx and MongoDB updated.
INFO:     127.0.0.1:64127 - "OPTIONS /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64127 - "GET /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
Raw RT Min from UI: ['1.3', '2.5']
Raw RT Max from UI: ['1.5', '2.7']
CORRECTED RT parameters:
  Yield RT: [1.3-1.5]
  Impurity RT ranges: [(2.5, 2.7)]
  Internal Standard RT: [0.0-10.0]
Checking for range overlaps:
WARNING: Yield [1.3-1.5] overlaps with ISO [0.0-10.0]
WARNING: ISO [0.0-10.0] overlaps with Impurity1 [2.5-2.7]

Transformed objectives: [{'name': 'oop', 'maximize': True, 'Property': 'oop'}, {'name': 'oops', 'maximize': False, 'Property': 'oops'}]        

============================================================
PREPARING DATAFRAME FOR OPTIMIZATION
============================================================
Original DataFrame shape: (7, 8)
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Original DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                  object
oops                 object
dtype: object

Objective columns: ['oop', 'oops']
  Equivalence 2                 : float64 -> float64
    Sample: 10.14239 -> 10.14239 (7/7 valid)
  Residence Time 1              : float64 -> float64
    Sample: 2.77589 -> 2.77589 (7/7 valid)
  Temperature                   : float64 -> float64
    Sample: 114.60209 -> 114.60209 (7/7 valid)
  Pump Flowrate 1               : float64 -> float64
    Sample: 0.6752 -> 0.6752 (7/7 valid)
  Pump Flowrate 2               : float64 -> float64
    Sample: 1.12602 -> 1.12602 (7/7 valid)
  Total Flowrate                : float64 -> float64
    Sample: 1.80122 -> 1.80122 (7/7 valid)
  oop                           : object -> float64
    Sample: 0.5821658911311641 -> 0.5821658911311641 (2/7 valid)
  oops                          : object -> float64
    Sample: 0.049024294593808734 -> 0.049024294593808734 (2/7 valid)

Converted DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                 float64
oops                float64
dtype: object

Sample data (first row):
  Equivalence 2                 : 10.14239 (type: float64)
  Residence Time 1              : 2.77589 (type: float64)
  Temperature                   : 114.60209 (type: float64)
  Pump Flowrate 1               : 0.6752 (type: float64)
  Pump Flowrate 2               : 1.12602 (type: float64)
  Total Flowrate                : 1.80122 (type: float64)
  oop                           : 0.5821658911311641 (type: float64)
  oops                          : 0.049024294593808734 (type: float64)
HPLC file loaded: C:\Users\T00078322\Documents\test\Page 10 - Copy (2).csv
HPLC file columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
HPLC file shape: (47, 5)
Sample HPLC data:
  Sample Name     RT   Area  Peak Area Percent  Signal Dimension
0    Sample-1  0.044   0.02               0.00                 1
1    Sample-1  0.114   0.01               0.00                 1
2    Sample-1  0.253   0.07               0.00                 1
3    Sample-1  0.442   0.04               0.00                 1
4    Sample-1  0.595  82.30               0.43                 1
RT range in file: 0.044 - 9.885

Experiment Status:
  Completed: 3/7 LHS
  SOR Iterations: 0/2

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10 - Copy (2).csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
HPLC processing completed. Response: [0.5821658911311641, 0.049024294593808734]
Row 3 values: [11.75071, 3.35094, 105.33866, 0.50888, 0.98323, 1.49212, '', '']
Empty/NaN indices found: [6, 7]
Response values to fill: [0.5821658911311641, 0.049024294593808734]
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0       10.14239           2.77589    114.60209          0.67520          1.12602         1.80122  0.582166  0.049024
1        7.03560           4.54285    133.83608          0.51030          0.59033         1.10063  0.582166  0.049024
2       11.75071           3.35094    105.33866          0.50888          0.98323         1.49212  0.582166  0.049024
3       13.83123           1.08853    126.13620          1.40288          3.19048         4.59337
4        7.98274           1.94811     97.44059          1.10984          1.45675         2.56659
5       13.37266           4.15638     90.78112          0.37607          0.82691         1.20297
6        5.74893           2.61046    119.66735          0.98462          0.93075         1.91537                     Dataframe before insertions
Row 3 updated. Excel saved to C:\Users\T00078322\Documents\test\optimization.xlsx and MongoDB updated.
INFO:     127.0.0.1:64127 - "OPTIONS /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64127 - "GET /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
Raw RT Min from UI: ['1.3', '2.5']
Raw RT Max from UI: ['1.5', '2.7']
CORRECTED RT parameters:
  Yield RT: [1.3-1.5]
  Impurity RT ranges: [(2.5, 2.7)]
  Internal Standard RT: [0.0-10.0]
Checking for range overlaps:
WARNING: Yield [1.3-1.5] overlaps with ISO [0.0-10.0]
WARNING: ISO [0.0-10.0] overlaps with Impurity1 [2.5-2.7]

Transformed objectives: [{'name': 'oop', 'maximize': True, 'Property': 'oop'}, {'name': 'oops', 'maximize': False, 'Property': 'oops'}]        

============================================================
PREPARING DATAFRAME FOR OPTIMIZATION
============================================================
Original DataFrame shape: (7, 8)
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Original DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                  object
oops                 object
dtype: object

Objective columns: ['oop', 'oops']
  Equivalence 2                 : float64 -> float64
    Sample: 10.14239 -> 10.14239 (7/7 valid)
  Residence Time 1              : float64 -> float64
    Sample: 2.77589 -> 2.77589 (7/7 valid)
  Temperature                   : float64 -> float64
    Sample: 114.60209 -> 114.60209 (7/7 valid)
  Pump Flowrate 1               : float64 -> float64
    Sample: 0.6752 -> 0.6752 (7/7 valid)
  Pump Flowrate 2               : float64 -> float64
    Sample: 1.12602 -> 1.12602 (7/7 valid)
  Total Flowrate                : float64 -> float64
    Sample: 1.80122 -> 1.80122 (7/7 valid)
  oop                           : object -> float64
    Sample: 0.5821658911311641 -> 0.5821658911311641 (3/7 valid)
  oops                          : object -> float64
    Sample: 0.049024294593808734 -> 0.049024294593808734 (3/7 valid)

Converted DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                 float64
oops                float64
dtype: object

Sample data (first row):
  Equivalence 2                 : 10.14239 (type: float64)
  Residence Time 1              : 2.77589 (type: float64)
  Temperature                   : 114.60209 (type: float64)
  Pump Flowrate 1               : 0.6752 (type: float64)
  Pump Flowrate 2               : 1.12602 (type: float64)
  Total Flowrate                : 1.80122 (type: float64)
  oop                           : 0.5821658911311641 (type: float64)
  oops                          : 0.049024294593808734 (type: float64)
HPLC file loaded: C:\Users\T00078322\Documents\test\Page 10 - Copy (3).csv
HPLC file columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
HPLC file shape: (47, 5)
Sample HPLC data:
  Sample Name     RT   Area  Peak Area Percent  Signal Dimension
0    Sample-1  0.044   0.02               0.00                 1
1    Sample-1  0.114   0.01               0.00                 1
2    Sample-1  0.253   0.07               0.00                 1
3    Sample-1  0.442   0.04               0.00                 1
4    Sample-1  0.595  82.30               0.43                 1
RT range in file: 0.044 - 9.885

Experiment Status:
  Completed: 4/7 LHS
  SOR Iterations: 0/2

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10 - Copy (3).csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
HPLC processing completed. Response: [0.5821658911311641, 0.049024294593808734]
Row 4 values: [13.83123, 1.08853, 126.1362, 1.40288, 3.19048, 4.59337, '', '']
Empty/NaN indices found: [6, 7]
Response values to fill: [0.5821658911311641, 0.049024294593808734]
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0       10.14239           2.77589    114.60209          0.67520          1.12602         1.80122  0.582166  0.049024
1        7.03560           4.54285    133.83608          0.51030          0.59033         1.10063  0.582166  0.049024
2       11.75071           3.35094    105.33866          0.50888          0.98323         1.49212  0.582166  0.049024
3       13.83123           1.08853    126.13620          1.40288          3.19048         4.59337  0.582166  0.049024
4        7.98274           1.94811     97.44059          1.10984          1.45675         2.56659
5       13.37266           4.15638     90.78112          0.37607          0.82691         1.20297
6        5.74893           2.61046    119.66735          0.98462          0.93075         1.91537                     Dataframe before insertions
Row 4 updated. Excel saved to C:\Users\T00078322\Documents\test\optimization.xlsx and MongoDB updated.
INFO:     127.0.0.1:64127 - "OPTIONS /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64127 - "GET /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
Raw RT Min from UI: ['1.3', '2.5']
Raw RT Max from UI: ['1.5', '2.7']
CORRECTED RT parameters:
  Yield RT: [1.3-1.5]
  Impurity RT ranges: [(2.5, 2.7)]
  Internal Standard RT: [0.0-10.0]
Checking for range overlaps:
WARNING: Yield [1.3-1.5] overlaps with ISO [0.0-10.0]
WARNING: ISO [0.0-10.0] overlaps with Impurity1 [2.5-2.7]

Transformed objectives: [{'name': 'oop', 'maximize': True, 'Property': 'oop'}, {'name': 'oops', 'maximize': False, 'Property': 'oops'}]        

============================================================
PREPARING DATAFRAME FOR OPTIMIZATION
============================================================
Original DataFrame shape: (7, 8)
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Original DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                  object
oops                 object
dtype: object

Objective columns: ['oop', 'oops']
  Equivalence 2                 : float64 -> float64
    Sample: 10.14239 -> 10.14239 (7/7 valid)
  Residence Time 1              : float64 -> float64
    Sample: 2.77589 -> 2.77589 (7/7 valid)
  Temperature                   : float64 -> float64
    Sample: 114.60209 -> 114.60209 (7/7 valid)
  Pump Flowrate 1               : float64 -> float64
    Sample: 0.6752 -> 0.6752 (7/7 valid)
  Pump Flowrate 2               : float64 -> float64
    Sample: 1.12602 -> 1.12602 (7/7 valid)
  Total Flowrate                : float64 -> float64
    Sample: 1.80122 -> 1.80122 (7/7 valid)
  oop                           : object -> float64
    Sample: 0.5821658911311641 -> 0.5821658911311641 (4/7 valid)
  oops                          : object -> float64
    Sample: 0.049024294593808734 -> 0.049024294593808734 (4/7 valid)

Converted DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                 float64
oops                float64
dtype: object

Sample data (first row):
  Equivalence 2                 : 10.14239 (type: float64)
  Residence Time 1              : 2.77589 (type: float64)
  Temperature                   : 114.60209 (type: float64)
  Pump Flowrate 1               : 0.6752 (type: float64)
  Pump Flowrate 2               : 1.12602 (type: float64)
  Total Flowrate                : 1.80122 (type: float64)
  oop                           : 0.5821658911311641 (type: float64)
  oops                          : 0.049024294593808734 (type: float64)
HPLC file loaded: C:\Users\T00078322\Documents\test\Page 10 - Copy (4).csv
HPLC file columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
HPLC file shape: (47, 5)
Sample HPLC data:
  Sample Name     RT   Area  Peak Area Percent  Signal Dimension
0    Sample-1  0.044   0.02               0.00                 1
1    Sample-1  0.114   0.01               0.00                 1
2    Sample-1  0.253   0.07               0.00                 1
3    Sample-1  0.442   0.04               0.00                 1
4    Sample-1  0.595  82.30               0.43                 1
RT range in file: 0.044 - 9.885

Experiment Status:
  Completed: 5/7 LHS
  SOR Iterations: 0/2

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10 - Copy (4).csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
HPLC processing completed. Response: [0.5821658911311641, 0.049024294593808734]
Row 5 values: [7.98274, 1.94811, 97.44059, 1.10984, 1.45675, 2.56659, '', '']
Empty/NaN indices found: [6, 7]
Response values to fill: [0.5821658911311641, 0.049024294593808734]
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0       10.14239           2.77589    114.60209          0.67520          1.12602         1.80122  0.582166  0.049024
1        7.03560           4.54285    133.83608          0.51030          0.59033         1.10063  0.582166  0.049024
2       11.75071           3.35094    105.33866          0.50888          0.98323         1.49212  0.582166  0.049024
3       13.83123           1.08853    126.13620          1.40288          3.19048         4.59337  0.582166  0.049024
4        7.98274           1.94811     97.44059          1.10984          1.45675         2.56659  0.582166  0.049024
5       13.37266           4.15638     90.78112          0.37607          0.82691         1.20297
6        5.74893           2.61046    119.66735          0.98462          0.93075         1.91537                     Dataframe before insertions
Row 5 updated. Excel saved to C:\Users\T00078322\Documents\test\optimization.xlsx and MongoDB updated.
INFO:     127.0.0.1:64127 - "OPTIONS /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64127 - "GET /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
Raw RT Min from UI: ['1.3', '2.5']
Raw RT Max from UI: ['1.5', '2.7']
CORRECTED RT parameters:
  Yield RT: [1.3-1.5]
  Impurity RT ranges: [(2.5, 2.7)]
  Internal Standard RT: [0.0-10.0]
Checking for range overlaps:
WARNING: Yield [1.3-1.5] overlaps with ISO [0.0-10.0]
WARNING: ISO [0.0-10.0] overlaps with Impurity1 [2.5-2.7]

Transformed objectives: [{'name': 'oop', 'maximize': True, 'Property': 'oop'}, {'name': 'oops', 'maximize': False, 'Property': 'oops'}]        

============================================================
PREPARING DATAFRAME FOR OPTIMIZATION
============================================================
Original DataFrame shape: (7, 8)
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Original DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                  object
oops                 object
dtype: object

Objective columns: ['oop', 'oops']
  Equivalence 2                 : float64 -> float64
    Sample: 10.14239 -> 10.14239 (7/7 valid)
  Residence Time 1              : float64 -> float64
    Sample: 2.77589 -> 2.77589 (7/7 valid)
  Temperature                   : float64 -> float64
    Sample: 114.60209 -> 114.60209 (7/7 valid)
  Pump Flowrate 1               : float64 -> float64
    Sample: 0.6752 -> 0.6752 (7/7 valid)
  Pump Flowrate 2               : float64 -> float64
    Sample: 1.12602 -> 1.12602 (7/7 valid)
  Total Flowrate                : float64 -> float64
    Sample: 1.80122 -> 1.80122 (7/7 valid)
  oop                           : object -> float64
    Sample: 0.5821658911311641 -> 0.5821658911311641 (5/7 valid)
  oops                          : object -> float64
    Sample: 0.049024294593808734 -> 0.049024294593808734 (5/7 valid)

Converted DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                 float64
oops                float64
dtype: object

Sample data (first row):
  Equivalence 2                 : 10.14239 (type: float64)
  Residence Time 1              : 2.77589 (type: float64)
  Temperature                   : 114.60209 (type: float64)
  Pump Flowrate 1               : 0.6752 (type: float64)
  Pump Flowrate 2               : 1.12602 (type: float64)
  Total Flowrate                : 1.80122 (type: float64)
  oop                           : 0.5821658911311641 (type: float64)
  oops                          : 0.049024294593808734 (type: float64)
HPLC file loaded: C:\Users\T00078322\Documents\test\Page 10 - Copy (5).csv
HPLC file columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
HPLC file shape: (47, 5)
Sample HPLC data:
  Sample Name     RT   Area  Peak Area Percent  Signal Dimension
0    Sample-1  0.044   0.02               0.00                 1
1    Sample-1  0.114   0.01               0.00                 1
2    Sample-1  0.253   0.07               0.00                 1
3    Sample-1  0.442   0.04               0.00                 1
4    Sample-1  0.595  82.30               0.43                 1
RT range in file: 0.044 - 9.885

Experiment Status:
  Completed: 6/7 LHS
  SOR Iterations: 0/2

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10 - Copy (5).csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
HPLC processing completed. Response: [0.5821658911311641, 0.049024294593808734]
Row 6 values: [13.37266, 4.15638, 90.78112, 0.37607, 0.82691, 1.20297, '', '']
Empty/NaN indices found: [6, 7]
Response values to fill: [0.5821658911311641, 0.049024294593808734]
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0       10.14239           2.77589    114.60209          0.67520          1.12602         1.80122  0.582166  0.049024
1        7.03560           4.54285    133.83608          0.51030          0.59033         1.10063  0.582166  0.049024
2       11.75071           3.35094    105.33866          0.50888          0.98323         1.49212  0.582166  0.049024
3       13.83123           1.08853    126.13620          1.40288          3.19048         4.59337  0.582166  0.049024
4        7.98274           1.94811     97.44059          1.10984          1.45675         2.56659  0.582166  0.049024
5       13.37266           4.15638     90.78112          0.37607          0.82691         1.20297  0.582166  0.049024
6        5.74893           2.61046    119.66735          0.98462          0.93075         1.91537                     Dataframe before insertions
Row 6 updated. Excel saved to C:\Users\T00078322\Documents\test\optimization.xlsx and MongoDB updated.
INFO:     127.0.0.1:64127 - "OPTIONS /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64127 - "GET /sor/api/result/6979a8ea4f50902bc315cd86 HTTP/1.1" 200 OK
Raw RT Min from UI: ['1.3', '2.5']
Raw RT Max from UI: ['1.5', '2.7']
CORRECTED RT parameters:
  Yield RT: [1.3-1.5]
  Impurity RT ranges: [(2.5, 2.7)]
  Internal Standard RT: [0.0-10.0]
Checking for range overlaps:
WARNING: Yield [1.3-1.5] overlaps with ISO [0.0-10.0]
WARNING: ISO [0.0-10.0] overlaps with Impurity1 [2.5-2.7]

Transformed objectives: [{'name': 'oop', 'maximize': True, 'Property': 'oop'}, {'name': 'oops', 'maximize': False, 'Property': 'oops'}]        

============================================================
PREPARING DATAFRAME FOR OPTIMIZATION
============================================================
Original DataFrame shape: (7, 8)
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Original DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                  object
oops                 object
dtype: object

Objective columns: ['oop', 'oops']
  Equivalence 2                 : float64 -> float64
    Sample: 10.14239 -> 10.14239 (7/7 valid)
  Residence Time 1              : float64 -> float64
    Sample: 2.77589 -> 2.77589 (7/7 valid)
  Temperature                   : float64 -> float64
    Sample: 114.60209 -> 114.60209 (7/7 valid)
  Pump Flowrate 1               : float64 -> float64
    Sample: 0.6752 -> 0.6752 (7/7 valid)
  Pump Flowrate 2               : float64 -> float64
    Sample: 1.12602 -> 1.12602 (7/7 valid)
  Total Flowrate                : float64 -> float64
    Sample: 1.80122 -> 1.80122 (7/7 valid)
  oop                           : object -> float64
    Sample: 0.5821658911311641 -> 0.5821658911311641 (6/7 valid)
  oops                          : object -> float64
    Sample: 0.049024294593808734 -> 0.049024294593808734 (6/7 valid)

Converted DataFrame dtypes:
Equivalence 2       float64
Residence Time 1    float64
Temperature         float64
Pump Flowrate 1     float64
Pump Flowrate 2     float64
Total Flowrate      float64
oop                 float64
oops                float64
dtype: object

Sample data (first row):
  Equivalence 2                 : 10.14239 (type: float64)
  Residence Time 1              : 2.77589 (type: float64)
  Temperature                   : 114.60209 (type: float64)
  Pump Flowrate 1               : 0.6752 (type: float64)
  Pump Flowrate 2               : 1.12602 (type: float64)
  Total Flowrate                : 1.80122 (type: float64)
  oop                           : 0.5821658911311641 (type: float64)
  oops                          : 0.049024294593808734 (type: float64)
HPLC file loaded: C:\Users\T00078322\Documents\test\Page 10 - Copy (6).csv
HPLC file columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
HPLC file shape: (47, 5)
Sample HPLC data:
  Sample Name     RT   Area  Peak Area Percent  Signal Dimension
0    Sample-1  0.044   0.02               0.00                 1
1    Sample-1  0.114   0.01               0.00                 1
2    Sample-1  0.253   0.07               0.00                 1
3    Sample-1  0.442   0.04               0.00                 1
4    Sample-1  0.595  82.30               0.43                 1
RT range in file: 0.044 - 9.885

Experiment Status:
  Completed: 7/7 LHS
  SOR Iterations: 0/2

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10 - Copy (6).csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
HPLC processing completed. Response: [0.5821658911311641, 0.049024294593808734]
Row 7 values: [5.74893, 2.61046, 119.66735, 0.98462, 0.93075, 1.91537, '', '']
Empty/NaN indices found: [6, 7]
Response values to fill: [0.5821658911311641, 0.049024294593808734]
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0       10.14239           2.77589    114.60209          0.67520          1.12602         1.80122  0.582166  0.049024
1        7.03560           4.54285    133.83608          0.51030          0.59033         1.10063  0.582166  0.049024
2       11.75071           3.35094    105.33866          0.50888          0.98323         1.49212  0.582166  0.049024
3       13.83123           1.08853    126.13620          1.40288          3.19048         4.59337  0.582166  0.049024
4        7.98274           1.94811     97.44059          1.10984          1.45675         2.56659  0.582166  0.049024
5       13.37266           4.15638     90.78112          0.37607          0.82691         1.20297  0.582166  0.049024
6        5.74893           2.61046    119.66735          0.98462          0.93075         1.91537  0.582166  0.049024 Dataframe before insertions
Row 7 updated. Excel saved to C:\Users\T00078322\Documents\test\optimization.xlsx and MongoDB updated.
Generating first SOR row based on 7 completed LHS experiments...

=== Generating 1 SOR rows upfront ===

Generating SOR row 1/1...
Starting optimization with 7 existing rows
Domain has 6 input vars, 2 objectives
Domain input variables: ['Equivalence_2', 'Residence_Time_1', 'Temperature', 'Pump_Flowrate_1', 'Pump_Flowrate_2', 'Total_Flowrate']
Domain objectives: ['oop', 'oops']
Original DataFrame columns: ['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops']
Mapped Equivalence 2 -> Equivalence_2
Mapped Residence Time 1 -> Residence_Time_1
Mapped Temperature -> Temperature
Mapped Pump Flowrate 1 -> Pump_Flowrate_1
Mapped Pump Flowrate 2 -> Pump_Flowrate_2
Mapped Total Flowrate -> Total_Flowrate
Mapped objective oop -> oop
Mapped objective oops -> oops
Clean DataFrame shape: (7, 8)
Clean DataFrame columns: ['Equivalence_2', 'Residence_Time_1', 'Temperature', 'Pump_Flowrate_1', 'Pump_Flowrate_2', 'Total_Flowrate', 'oop', 'oops']
Valid rows for optimization: 7
Creating DataSet...
DataSet created successfully with 7 rows
Trying TSEMO optimization...
C:\Users\T00078322\.conda\envs\sorOldEnv\lib\site-packages\botorch\models\utils\assorted.py:201: InputDataWarning: Input data is not standardized. Please consider scaling the input to zero mean and unit variance.
  warnings.warn(msg, InputDataWarning)
C:\Users\T00078322\.conda\envs\sorOldEnv\lib\site-packages\botorch\models\utils\assorted.py:201: InputDataWarning: Input data is not standardized. Please consider scaling the input to zero mean and unit variance.
  warnings.warn(msg, InputDataWarning)
TSEMO failed with error: No module named 'pymoo.factory'
Falling back to SNOBFIT...
SNOBFIT optimization successful
C:\Users\Public\Documents\React_SOR\server\utils.py:473: PerformanceWarning: dropping on a non-lexsorted multi-index without a level parameter
may impact performance.
  out = out.drop(columns=["strategy"])
Final optimization output shape: (1, 6)
Final optimization output columns: [('Equivalence_2', 'DATA'), ('Residence_Time_1', 'DATA'), ('Temperature', 'DATA'), ('Pump_Flowrate_1', 'DATA'), ('Pump_Flowrate_2', 'DATA'), ('Total_Flowrate', 'DATA')]
MultiIndex columns detected, flattening...
Flattened columns: ['Equivalence_2', 'Residence_Time_1', 'Temperature', 'Pump_Flowrate_1', 'Pump_Flowrate_2', 'Total_Flowrate']
Sample output data: {'Equivalence_2': 7.306075908, 'Residence_Time_1': 1.6244285232, 'Temperature': 127.97699365360003, 'Pump_Flowrate_1': 0.4597952499, 'Pump_Flowrate_2': 2.0834741935000003}
  Equivalence 2 <- Equivalence_2 = 7.306075908
  Residence Time 1 <- Residence_Time_1 = 1.6244285232
  Temperature <- Temperature = 127.97699365360003
  Pump Flowrate 1 <- Pump_Flowrate_1 = 0.4597952499
  Pump Flowrate 2 <- Pump_Flowrate_2 = 2.0834741935000003
  Total Flowrate <- Total_Flowrate = 3.912148219200001
  oop = NaN (objective - will be filled by HPLC)
  oops = NaN (objective - will be filled by HPLC)
Added SOR row 1, total rows now: 8

=== Successfully generated 1 SOR rows ===
Total rows in DataFrame: 8
   Equivalence 2  Residence Time 1  Temperature  Pump Flowrate 1  Pump Flowrate 2  Total Flowrate       oop      oops
0      10.142390          2.775890   114.602090         0.675200         1.126020        1.801220  0.582166  0.049024
1       7.035600          4.542850   133.836080         0.510300         0.590330        1.100630  0.582166  0.049024
2      11.750710          3.350940   105.338660         0.508880         0.983230        1.492120  0.582166  0.049024
3      13.831230          1.088530   126.136200         1.402880         3.190480        4.593370  0.582166  0.049024
4       7.982740          1.948110    97.440590         1.109840         1.456750        2.566590  0.582166  0.049024
5      13.372660          4.156380    90.781120         0.376070         0.826910        1.202970  0.582166  0.049024
6       5.748930          2.610460   119.667350         0.984620         0.930750        1.915370  0.582166  0.049024
0       7.306076          1.624429   127.976994         0.459795         2.083474        3.912148       NaN       NaN -------------------SOR New Row

=== Processing HPLC File: C:\Users\T00078322\Documents\test\Page 10 - Copy (6).csv ===
Available columns: ['Sample Name', 'RT', 'Area', 'Peak Area Percent', 'Signal Dimension']
Using columns: Area='Area', RT='RT'
Extracted 47 peaks from HPLC data
RT range in data: 0.044 - 9.885
Area range in data: 0.010 - 11252.440
Peaks in yield range [1.3-1.5]: 1
Peaks in ISO range [0.0-10.0]: 47
Peaks in impurity 1 range [2.5-2.7]: 2
Final HPLC Parameters: {'YminRT': 1.3, 'YmaxRT': 1.5, 'minRTISO': 0.0, 'maxRTISO': 10.0, 'IminRT_list': [2.5], 'ImaxRT_list': [2.7]}

=== Processing HPLC Data ===
Total peaks in file: 47
Yield RT range: [1.3-1.5]
ISO RT range: [0.0-10.0]
Impurity RT ranges: [(2.5, 2.7)]
Yield: Found 1 peaks, Total area: 11252.44
Internal Standard: Found 47 peaks, Total area: 19328.580000000005
Yield ratio: 0.5822
Impurity RT range [2.5-2.7]: Found 2 peaks, Total area: 947.5699999999999
Impurity 1 result: 0.0490
Final response: [0.5821658911311641, 0.049024294593808734]
Calculated response: [0.5821658911311641, 0.049024294593808734]
[['Equivalence 2', 'Residence Time 1', 'Temperature', 'Pump Flowrate 1', 'Pump Flowrate 2', 'Total Flowrate', 'oop', 'oops'], [10.14239, 2.77589, 114.60209, 0.6752, 1.12602, 1.80122, 0.5821658911311641, 0.049024294593808734], [7.0356, 4.54285, 133.83608, 0.5103, 0.59033, 1.10063, 0.5821658911311641, 0.049024294593808734], [11.75071, 3.35094, 105.33866, 0.50888, 0.98323, 1.49212, 0.5821658911311641, 0.049024294593808734], [13.83123, 1.08853, 126.1362, 1.40288, 3.19048, 4.59337, 0.5821658911311641, 0.049024294593808734], [7.98274, 1.94811, 97.44059, 1.10984, 1.45675,
2.56659, 0.5821658911311641, 0.049024294593808734], [13.37266, 4.15638, 90.78112, 0.37607, 0.82691, 1.20297, 0.5821658911311641, 0.049024294593808734], [5.74893, 2.61046, 119.66735, 0.98462, 0.93075, 1.91537, 0.5821658911311641, 0.049024294593808734], [7.306075908, 1.6244285232, 127.97699365360003, 0.4597952499, 2.0834741935000003, 3.912148219200001, nan, nan]] _______________FINAL RESULT

