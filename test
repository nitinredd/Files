elif input1 == 2:  # EMA
    # ... existing EMA code ...

    # ====== SAME NEW ANALYSIS BLOCK ======
    try:
        if check_same_time_points(reference_df, test_df):
            print("\nRunning comprehensive combination analysis...")
            regulation_map = {1: "FDA", 2: "EMA", 3: "China", 4: "ASEAN", 5: "ANVISA"}
            
            analysis_results = analyze_combinations(
                reference_df.copy(),
                test_df.copy(),
                regulation_map[input1]
            )
            
            display_combination_results(analysis_results, regulation_map[input1])
        else:
            print("\nSkipping combination analysis: Time points mismatch")
    except Exception as e:
        print(f"\nCombination analysis error: {str(e)}")
    
    R_Regulation(file_path)
